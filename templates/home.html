<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Dashboard</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <script>
      window.csrfToken = "{{ csrf_token() }}";
    </script>
  </head>
  <body>
    <!-- Header -->
    <header>
      <h1>Expense Tracker</h1>
      <div class="logout-container">
        <span>{{ user }}</span>
        <a href="{{ url_for('logout') }}" class="logout-btn">Logout</a>
      </div>
    </header>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Dashboard -->
    <div class="dashboard-container">
      <!-- Add Expense Card -->
      <div class="add-expense-card card">
        <h3 class="card-title">Add Expense</h3>
        <form id="expenseForm">
          <div class="form-row">
            <label for="date">Date:</label>
            <input type="date" name="date" required />
          </div>
          <div class="form-row">
            <label for="category">Category:</label>
            <input
              type="text"
              name="category"
              placeholder="e.g., Food"
              required
            />
          </div>
          <div class="form-row">
            <label for="amount">Amount:</label>
            <input
              type="number"
              name="amount"
              step="0.01"
              placeholder="0.00"
              required
            />
          </div>
          <div class="form-row">
            <label for="description">Description:</label>
            <input type="text" name="description" placeholder="Optional" />
          </div>
          <button type="submit" class="primary-btn">Add Expense</button>
        </form>
      </div>

      <!-- Expenses Table Card -->
      <div class="expenses-card card">
        <h3 class="card-title">Your Expenses</h3>
        <div class="table-wrapper">
          <table id="expenseTable">
            <thead>
              <tr>
                <th>Date</th>
                <th>Category</th>
                <th>Amount</th>
                <th>Description</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Charts -->
    <div class="charts-container">
      <div class="chart-card card">
        <h3 class="card-title">Category Summary</h3>
        <div id="categoryChart"></div>
      </div>
      <div class="chart-card card">
        <h3 class="card-title">Monthly Summary</h3>
        <div id="monthlyChart"></div>
      </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="edit-modal">
      <div class="edit-modal-content">
        <h3>Edit Expense</h3>
        <form id="editExpenseForm">
          <div class="form-row">
            <label for="date">Date:</label>
            <input type="date" name="date" required />
          </div>
          <div class="form-row">
            <label for="category">Category:</label>
            <input type="text" name="category" required />
          </div>
          <div class="form-row">
            <label for="amount">Amount:</label>
            <input type="number" name="amount" step="0.01" required />
          </div>
          <div class="form-row">
            <label for="description">Description:</label>
            <input type="text" name="description" />
          </div>
          <div class="modal-buttons">
            <button type="submit" class="save-btn">Save</button>
            <button type="button" id="editCancel" class="cancel-btn">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
    <!-- Delete Modal -->
    <div id="deleteModal" class="delete-modal">
      <div class="delete-modal-content">
        <h3>Confirm Delete</h3>
        <p>Are you sure you want to delete this expense?</p>
        <div class="modal-buttons">
          <button id="deleteConfirm" class="save-btn">Delete</button>
          <button id="deleteCancel" class="cancel-btn">Cancel</button>
        </div>
      </div>
    </div>

    <!-- JS -->
    <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
    <script src="{{ url_for('static', filename='js/home.js') }}"></script>
  </body>
</html>
